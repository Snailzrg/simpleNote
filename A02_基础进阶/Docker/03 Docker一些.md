[toc]



# ä¸€: Docker  ç”Ÿäº§SSHæœåŠ¡çš„é•œåƒ

### 1.1 ubuntu å®‰è£… curl

Dockeré•œåƒä¸ºäº†ç²¾ç®€å®¹é‡ï¼Œé»˜è®¤åˆ é™¤è¿™äº›ä¿¡æ¯ï¼Œå®‰è£…çš„æ—¶å€™åˆä¸‹é¢ä¸¤ç§æ–¹å¼ï¼š

1. ä½¿ç”¨ apt-get update æ›´æ–°ä¸€æ¬¡
2. ç¼–è¾‘/etc/apt/sources.listæ–‡ä»¶ï¼Œå°†é»˜è®¤è½¯ä»¶æºæ”¹ä¸ºå›½å†…çš„æº

```
apt-get update
apt-get install curl
```

### 1.2 åˆ›å»ºæ”¯æŒSSHæœåŠ¡çš„é•œåƒ

#### åŸºäºcommit å‘½ä»¤åˆ›å»º

```
docker commit CONTAINER [REPOSITORY[:TAG]]
```

1.å¯åŠ¨ubuntu

```
docker run -it --name ssh ubuntu:14.04 /bin/bash
```

2.æ›´æ–°æº(å·²æ›´æ–°çš„å¯å¿½ç•¥)

```
apt-get update
```

3.å®‰è£…ssh

```
apt-get install openssh-server
```

å¦‚æœé€Ÿåº¦æ…¢å¯ä»¥æ”¹æˆå›½å†…æºï¼Œå…·ä½“æºç™¾åº¦ä¸€ä¸‹å°±æœ‰äº†ï¼Œä¿®æ”¹ä½ç½®å¦‚ä¸‹

```
vi /etc/apt/sources.list.d/163.list
```

4.å¯åŠ¨sshæœåŠ¡ï¼Œéœ€è¦/var/run/sshdå­˜åœ¨ï¼Œæ‰‹åŠ¨åˆ›å»ºå¹¶å¯åŠ¨æœåŠ¡

```
mkdir -p /var/run/sshd
/usr/sbin/sshd -D &
```

5.æŸ¥çœ‹22ç«¯å£(ssh æœåŠ¡é»˜è®¤ç›‘å¬ç«¯å£),çœ‹æ˜¯å¦æ­£å¸¸å¯åŠ¨

```
netstat -tunlp
```

6.ä¿®æ”¹æœåŠ¡çš„å®‰å…¨ç™»å½•é…ç½®ï¼Œå–æ¶ˆpamç™»å½•é™åˆ¶

```
sed -ri 's/session required pam_loginuid.so/#session required pam_loginuid.so/g' /etc/pam.d/sshd
```

7.å½“å‰è¿™ä¸ªå®¹å™¨ root ç”¨æˆ·ç›®å½•ä¸‹å»ºç«‹.sshç›®å½•ï¼Œå¤åˆ¶éœ€è¦çš„å…¬é’¥åˆ° authorized_keys æ–‡ä»¶

```
mkdir root/.ssh
vi /root/.ssh/authorized_keys
```

**æ³¨æ„ï¼šauthorized_keysæ–‡ä»¶çš„æƒé™å¾ˆç‰¹æ®Šéœ€è¦è®¾ç½®ä¸º600ï¼Œæ‰å¯ä»¥**(å…·ä½“åŸå› åé¢è¡¥å……)

```
chmod 600 authorized_keys
```

å› ä¸ºæˆ‘æ˜¯åœ¨è™šæ‹Ÿæœºä¸­åˆ›å»ºçš„ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥æŠŠè™šæ‹Ÿæœºçš„å…¬é’¥ç²˜è´´åˆ°authorized_keysæ–‡ä»¶ä¸­è¿›è¡Œæµ‹è¯•ã€‚

ä½¿ç”¨ ssh-keygen -t rsa å‘½ä»¤ç”Ÿæˆ(dsa ä¸åŒçš„åŠ å¯†æ–¹å¼)

```
ssh-keygen -t dsa

cat /root/.ssh/id_rsa.pub

//å¤åˆ¶ç²˜è´´åˆ°å¯åŠ¨å®¹å™¨çš„authorized_keysä¸­
```

8.åˆ›å»ºè‡ªåŠ¨å¯åŠ¨sshæœåŠ¡çš„run.sh,å¹¶æ·»åŠ å¯æ‰§è¡Œæƒé™

```
vi /run.sh
chmod +x run.sh
```

å†…å®¹ä¸ºï¼š

```
#!/bin/bash
/usr/sbin/sshd -D
```

9.é€€å‡ºå®¹å™¨

```
exit
```

10.ä¿å­˜é•œåƒ(ä¸Šé¢å®¹å™¨è¿è¡Œçš„æ—¶å€™å–åå®¹å™¨åä¸ºssh)

```
//ä¿å­˜å®¹å™¨ä¸ºé•œåƒ
docker commit ssh sshd:ubuntu

//æŸ¥çœ‹é•œåƒ
docker images
```

11.å¯åŠ¨ä¸€ä¸ªæ–°å®¹å™¨ï¼Œå¹¶æ·»åŠ ç«¯å£æ˜ å°„10022-->22. 10022ä¸ºå®¿ä¸»æœºç«¯å£ï¼Œ22æ˜¯å®¹å™¨sshæœåŠ¡ç›‘å¬ç«¯å£ç«¯å£

```
docker run -p 10022:22 -d sshd:ubuntu /run.sh

//å¯åŠ¨åæŸ¥çœ‹è¿è¡Œæƒ…å†µ
docker ps
```

12.è™šæ‹Ÿæœºä¸­æµ‹è¯•è¿æ¥æƒ…å†µ

```
ssh 192.168.1.200 -p 10022
```

è¿›å»åæ•²lså‘½ä»¤çš„æ—¶å€™éœ€è¦ä½¿ç”¨ /bin/ls ï¼ˆæš‚æ—¶æ²¡æ‰¾åˆ°è¿™ä¸ªè§£å†³ åé¢è¡¥å……ï¼‰

#### 1.3 ä½¿ç”¨Dockerfileåˆ›å»º

1.åˆ›å»ºä¸€ä¸ªsshd_ubuntuå·¥ä½œç›®å½•

```
mkdir sshd_ubuntu
```

2.åˆ›å»ºDockerfile å’Œ run.sh

```
cd sshd_ubuntu
touch Dockerfile run.sh
```

3.ç¼–å†™run.shè„šæœ¬

```
#!/bin/bash
/usr/sbin/sshd -D
```

4.ç¼–å†™authorized_keysæ–‡ä»¶

```
ssh-keygen -t rsa
...
cat ~/.ssh/id_rsa.pub > authorized_keys
```

5.ç¼–å†™Dockerfileæ–‡ä»¶

```
# è®¾ç½®ç»§æ‰¿é•œåƒ
FROM ubuntu:14.04

# æä¾›ä¸€äº›ä½œè€…ä¿¡æ¯
MAINTAINER from www.dockerpool.com by waitfish

# ä¸‹é¢å¼€å§‹è¿è¡Œå‘½ä»¤
RUN apt-get update

# å®‰è£…sshæœåŠ¡
RUN apt-get install -y openssh-server
RUN mkdir -p /var/run/sshd
RUN mkdir -p /root/.ssh

# å–æ¶ˆpamé™åˆ¶
RUN sed -ri 's/session required pam_loginuid.so/#session required pam_loginuid.so/g' /etc/pam.d/sshd

# å¤åˆ¶é…ç½®æ–‡ä»¶åˆ°ç›¸åº”ä½ç½®ï¼Œå¹¶èµ‹äºˆè„šæœ¬å¯æ‰§è¡Œæƒé™
ADD authorized_keys /root/.ssh/authorized_keys
ADD run.sh /run.sh
RUN chmod 755 /run.sh

# å¼€æ”¾ç«¯å£
EXPOSE 22

# è®¾ç½®è‡ªå¯åŠ¨å‘½ä»¤
CMD ["/run.sh"]
```

6.åˆ›å»ºé•œåƒ

åœ¨sshd_ubuntuç›®å½•ä¸‹ï¼Œä½¿ç”¨docker build å‘½ä»¤æ¥åˆ›å»ºé•œåƒï¼Œæœ€åè¿˜éœ€è¦åŠ "."è¡¨ç¤ºå½“å‰ç›®å½•

```
docker build -t sshd:dockerfile .
```

7.è¿è¡Œå®¹å™¨

```
docker run -d -p 10022:22 sshd:dockerfile

docker ps
```

8.è™šæ‹Ÿæœºä¸­æµ‹è¯•è¿æ¥æƒ…å†µ

```
ssh 192.168.1.200 -p 10022
```

åœ¨æ¨å‡ºå…¶ä»–é«˜æ•ˆå¯¹å®¹å™¨ç»´æŠ¤ä¹‹å‰ï¼ŒsshæœåŠ¡è¿˜æ˜¯æ¯”è¾ƒé‡è¦çš„ã€‚æ¯”è¾ƒé€‚åˆç”Ÿäº§ç¯èŠ‚ã€‚



# äºŒ:ä¸€äº›å¸¸è§å‘½ä»¤

## 2.1é‡å‘½å

> docker rename æ—§å®¹å™¨å æ–°å®¹å™¨å

## 2.2 dockeræŒ‚è½½

> ```
> # docker run -it -v /å®¿ä¸»æœºç›®å½•:/å®¹å™¨ç›®å½• é•œåƒå /bin/bash
> 
> è­¬å¦‚æˆ‘è¦å¯åŠ¨ä¸€ä¸ªcentoså®¹å™¨ï¼Œå®¿ä¸»æœºçš„/testç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/softç›®å½•ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼æŒ‡å®šï¼š
> # docker run -it -v /test:/soft centos /bin/bash
> å†’å·":"å‰é¢çš„ç›®å½•æ˜¯å®¿ä¸»æœºç›®å½•ï¼Œåé¢çš„ç›®å½•æ˜¯å®¹å™¨å†…ç›®å½•ã€‚
> 
> ä¸€ã€å®¹å™¨ç›®å½•ä¸å¯ä»¥ä¸ºç›¸å¯¹è·¯å¾„
> äºŒã€å®¿ä¸»æœºç›®å½•å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨ç”Ÿæˆ
> # docker run -it -v test1:/soft centos /bin/bash
> ä¸‰ã€å®¿ä¸»æœºçš„ç›®å½•å¦‚æœä¸ºç›¸å¯¹è·¯
>      ãƒ»å®¹å™¨å†…çš„/softç›®å½•æŒ‚è½½çš„æ˜¯å®¿ä¸»æœºä¸Šçš„/var/lib/docker/volumes/test1/_dataç›®å½•
>  
>      ãƒ»æ‰€è°“çš„ç›¸å¯¹è·¯å¾„æŒ‡çš„æ˜¯/var/lib/docker/volumes/ï¼Œ
> ã€€ã€€ã€€ã€€ä¸å®¿ä¸»æœºçš„å½“å‰ç›®å½•æ— å…³ã€‚
>  
> å››ã€å¦‚æœåœ¨å®¹å™¨å†…ä¿®æ”¹äº†ç›®å½•çš„å±ä¸»å’Œå±ç»„ï¼Œé‚£ä¹ˆå¯¹åº”çš„æŒ‚è½½ç‚¹ä¼šè·Ÿç€ä¿®æ”¹
> ```

è¿™é‡Œ-itæ˜¯å‚æ•°ä½œç”¨æ˜¯ï¼š

**-i:** ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›

**-t:** ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›

å°±æ˜¯å®¹å™¨ä¸ä½ çš„ç»ˆç«¯é€šä¿¡è¾“å…¥è¾“å‡ºã€‚

æœ€åçš„/bin/bashæ˜¯commandå‚æ•°ã€‚

è¿™é‡Œä¸€å¼€å§‹æˆ‘æé”™çš„åœ°æ–¹æ˜¯æŒ‚è½½æ–¹å‘ï¼Œå› æ­¤ä¸ç†è§£åˆ°åº•æœ‰ä½•ç”¨ã€‚

è¦çŸ¥é“ï¼Œè¿™å¥çš„æ„æ€æ˜¯å°†å®¿ä¸»æœºç›®å½•æŒ‚è½½åˆ°å®¹å™¨é‡Œï¼Œè¿™ä¸ªæ–¹å‘è¦ææ¸…ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆçš„ç–‘æƒ‘å°±ææ¸…æ¥šäº†ã€‚

è¿™é‡ŒæŠŠå®¹å™¨æƒ³æˆä¸€ä¸ªå•ç‹¬çš„ç³»ç»Ÿï¼Œæˆ–è€…è¯´ç”µè„‘ï¼Œè€Œä½ çš„å®¿ä¸»æœºç›®å½•æ˜¯ä¸€ä¸ªUç›˜ï¼ŒæŒ‚è½½åï¼Œä½ å¾€å®¿ä¸»æœºè¯¥ç›®å½•é‡Œæ”¾æ–‡ä»¶ï¼Œé‚£ä¹ˆé€šè¿‡å®¹å™¨é‡Œå¯¹åº”ç›®å½•ä¾¿å¯ä»¥è®¿é—®åˆ°æ­¤æ–‡ä»¶ï¼Œä¸éœ€è¦é‡æ–°ç”Ÿæˆå®¹å™¨å°±å¯ä»¥åœ¨â€œå®¹å™¨å¤–éƒ¨â€æ·»åŠ å’Œä¿®æ”¹æŸäº›æ–‡ä»¶ï¼Œå¦‚æˆ‘ç”¨Mythriå·¥å…·æ£€æµ‹æ™ºèƒ½åˆçº¦æ¼æ´ï¼Œé‡‡ç”¨dockerå®¹å™¨å¦‚ä¸‹å‘½ä»¤ï¼šdocker run -v $(pwd):/tmp mythril/myth analyze /tmp/test.solï¼Œå°†å®¿ä¸»æœºå½“å‰ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„tmpç›®å½•ï¼Œåˆ™åœ¨å®¹å™¨ä¸­æ“ä½œæ—¶tmpç›®å½•å°±æ˜¯å½“å‰çš„ç›®å½•ï¼Œåœ¨å½“æœŸç›®å½•ä¸­æ–°å»ºæ™ºèƒ½åˆçº¦æˆ–è€…æ”¹å˜æ—§çš„åˆçº¦å¦‚test.solçš„å†…å®¹ï¼Œå†é€šè¿‡analyzeå‘½ä»¤æ£€æµ‹åˆçº¦å³å¯ï¼Œæ—¢ä¸ç”¨é‡æ–°ç”Ÿæˆå®¹å™¨ï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“å®¹å™¨çš„ç»å¯¹è·¯å¾„ä»è€Œå°†æ–°åˆçº¦å¤åˆ¶è¿›å»ï¼Œåªéœ€è¦å¤åˆ¶åˆ°å½“å‰ç›®å½•å³å¯

## 2.3: ç»‘å®šæŒ‚è½½

1.run

https://www.cnblogs.com/wdliu/p/10429819.html

docker run [OPTIONS] IMAGE [COMMOND] [ARGS...]

OPTIONS è¯´æ˜

	--name="å®¹å™¨æ–°åå­—": ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›
	-d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼Œä¹Ÿå³å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨ï¼›
	-iï¼šä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›
	-tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›
	-P: éšæœºç«¯å£æ˜ å°„ï¼›
	-p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæœ‰ä»¥ä¸‹å››ç§æ ¼å¼
	      ip:hostPort:containerPort
	      ip::containerPort
	      hostPort:containerPort
	      containerPort
	      
	  å¸¸ç”¨OPTIONSè¡¥è¶³ï¼š
	  --nameï¼šå®¹å™¨åå­—
	  --networkï¼šæŒ‡å®šç½‘ç»œ
	  --rmï¼šå®¹å™¨åœæ­¢è‡ªåŠ¨åˆ é™¤å®¹å™¨
	  -iï¼š--interactive,äº¤äº’å¼å¯åŠ¨
	  -tï¼š--ttyï¼Œåˆ†é…ç»ˆç«¯
	  -vï¼š--volume,æŒ‚åœ¨æ•°æ®å·
	  -dï¼š--detachï¼Œåå°è¿è¡Œ
	  
	-d, --detach=false # åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼›
	-i, --interactive=false # ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›
	-t, --tty=false # ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›
	-u, --user="" # æŒ‡å®šå®¹å™¨çš„ç”¨æˆ·
	-a, --attach=[] # ç™»å½•å®¹å™¨ï¼ˆå¿…é¡»æ˜¯ä»¥docker run -då¯åŠ¨çš„å®¹å™¨ï¼‰
	-w, --workdir="" # æŒ‡å®šå®¹å™¨çš„å·¥ä½œç›®å½•
	-c, --cpu-shares=0 # è®¾ç½®å®¹å™¨CPUæƒé‡ï¼Œåœ¨CPUå…±äº«åœºæ™¯ä½¿ç”¨
	-e, --env=[] # æŒ‡å®šç¯å¢ƒå˜é‡ï¼Œå®¹å™¨ä¸­å¯ä»¥ä½¿ç”¨è¯¥ç¯å¢ƒå˜é‡
	-m, --memory="" # æŒ‡å®šå®¹å™¨çš„å†…å­˜ä¸Šé™
	-P, --publish-all=false # æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£
	-p, --publish=[] # æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£
	-h, --hostname="" # æŒ‡å®šå®¹å™¨çš„ä¸»æœºå
	-v, --volume=[] # ç»™å®¹å™¨æŒ‚è½½å­˜å‚¨å·ï¼ŒæŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•
	--volumes-from=[] # ç»™å®¹å™¨æŒ‚è½½å…¶ä»–å®¹å™¨ä¸Šçš„å·ï¼ŒæŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•
	--cap-add=[] # æ·»åŠ æƒé™ï¼Œæƒé™æ¸…å•è¯¦è§ï¼šhttp://linux.die.net/man/7/capabilities
	--cap-drop=[] # åˆ é™¤æƒé™ï¼Œæƒé™æ¸…å•è¯¦è§ï¼šhttp://linux.die.net/man/7/capabilities
	--cidfile="" # è¿è¡Œå®¹å™¨åï¼Œåœ¨æŒ‡å®šæ–‡ä»¶ä¸­å†™å…¥å®¹å™¨PIDå€¼ï¼Œä¸€ç§å…¸å‹çš„ç›‘æ§ç³»ç»Ÿç”¨æ³•
	--cpuset="" # è®¾ç½®å®¹å™¨å¯ä»¥ä½¿ç”¨å“ªäº›CPUï¼Œæ­¤å‚æ•°å¯ä»¥ç”¨æ¥å®¹å™¨ç‹¬å CPU
	--device=[] # æ·»åŠ ä¸»æœºè®¾å¤‡ç»™å®¹å™¨ï¼Œç›¸å½“äºè®¾å¤‡ç›´é€š
	--dns=[] # æŒ‡å®šå®¹å™¨çš„dnsæœåŠ¡å™¨
	--dns-search=[] # æŒ‡å®šå®¹å™¨çš„dnsæœç´¢åŸŸåï¼Œå†™å…¥åˆ°å®¹å™¨çš„/etc/resolv.confæ–‡ä»¶
	--entrypoint="" # è¦†ç›–imageçš„å…¥å£ç‚¹
	--env-file=[] # æŒ‡å®šç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œæ–‡ä»¶æ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªç¯å¢ƒå˜é‡
	--expose=[] # æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£ï¼Œå³ä¿®æ”¹é•œåƒçš„æš´éœ²ç«¯å£
	--link=[] # æŒ‡å®šå®¹å™¨é—´çš„å…³è”ï¼Œä½¿ç”¨å…¶ä»–å®¹å™¨çš„IPã€envç­‰ä¿¡æ¯
	--lxc-conf=[] # æŒ‡å®šå®¹å™¨çš„é…ç½®æ–‡ä»¶ï¼Œåªæœ‰åœ¨æŒ‡å®š--exec-driver=lxcæ—¶ä½¿ç”¨
	--name="" # æŒ‡å®šå®¹å™¨åå­—ï¼Œåç»­å¯ä»¥é€šè¿‡åå­—è¿›è¡Œå®¹å™¨ç®¡ç†ï¼Œlinksç‰¹æ€§éœ€è¦ä½¿ç”¨åå­—
	--net="bridge" # å®¹å™¨ç½‘ç»œè®¾ç½®:
	    bridge  # ä½¿ç”¨docker daemonæŒ‡å®šçš„ç½‘æ¡¥
	    host  # å®¹å™¨ä½¿ç”¨ä¸»æœºçš„ç½‘ç»œ
	    container:NAME_or_ID > # ä½¿ç”¨å…¶ä»–å®¹å™¨çš„ç½‘è·¯ï¼Œå…±äº«IPå’ŒPORTç­‰ç½‘ç»œèµ„æº
	    none # å®¹å™¨ä½¿ç”¨è‡ªå·±çš„ç½‘ç»œï¼ˆç±»ä¼¼--net=bridgeï¼‰ï¼Œä½†æ˜¯ä¸è¿›è¡Œé…ç½®
	--privileged=false # æŒ‡å®šå®¹å™¨æ˜¯å¦ä¸ºç‰¹æƒå®¹å™¨ï¼Œç‰¹æƒå®¹å™¨æ‹¥æœ‰æ‰€æœ‰çš„capabilities
	--restart="no" # æŒ‡å®šå®¹å™¨åœæ­¢åçš„é‡å¯ç­–ç•¥:
	    no # å®¹å™¨é€€å‡ºæ—¶ä¸é‡å¯
	    on-failure # å®¹å™¨æ•…éšœé€€å‡ºï¼ˆè¿”å›å€¼éé›¶ï¼‰æ—¶é‡å¯
	    always # å®¹å™¨é€€å‡ºæ—¶æ€»æ˜¯é‡å¯
	--rm=false # æŒ‡å®šå®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤å®¹å™¨(ä¸æ”¯æŒä»¥docker run -då¯åŠ¨çš„å®¹å™¨)
	--sig-proxy=true # è®¾ç½®ç”±ä»£ç†æ¥å—å¹¶å¤„ç†ä¿¡å·ï¼Œä½†æ˜¯SIGCHLDã€SIGSTOPå’ŒSIGKILLä¸èƒ½è¢«ä»£ç†

> 1. \# eg: ä½¿ç”¨é•œåƒcentos:latestä»¥äº¤äº’æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,åœ¨å®¹å™¨å†…æ‰§è¡Œ/bin/bashå‘½ä»¤ã€‚
> 2. docker run -it centos /bin/bash



# ä¸‰ï¼š docker å¯è§†åŒ–å·¥å…·

> https://juejin.cn/post/6847902192217620494
>
> å¸¸è§çš„å¯è§†åŒ–å·¥å…·å¦‚`DockerUI`ã€`Shipyard`ã€`Rancher`ã€`Portainer`ç­‰ã€‚æŸ¥çœ‹å¯¹æ¯”äº†ä¸€ç•ªï¼Œæœ€åè§‰å¾—`Portainer`è¿˜ä¸é”™

## 3.1: Portainer

`Portainer`æ˜¯ä¸€ä¸ªè½»é‡çº§çš„`Docker`ç¯å¢ƒç®¡ç†UIï¼Œä¸»è¦ä¼˜ç‚¹æœ‰ï¼š

- è½»é‡çº§ï¼Œé•œåƒåªæœ‰å‡ åMï¼Œç›¸å¯¹å…¶å®ƒUIå·¥å…·æ¥è¯´ååˆ†è½»å·§ï¼›
- ä½¿ç”¨æ–¹ä¾¿ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ª`Docker`åº”ç”¨ï¼Œç›´æ¥æ‹‰å–é•œåƒåå¯åŠ¨å³å¯ï¼›
- æŒç»­æ›´æ–°ï¼Œä½œä¸ºä¼˜ç§€çš„å¼€æºé¡¹ç›®ï¼Œ`GitHub`è¿˜åœ¨æŒç»­ç»´æŠ¤å’Œæ›´æ–°ï¼›
- åŠŸèƒ½é½å…¨ï¼Œå¦‚ä»¥ä¸‹å‡ ç‚¹ï¼š
  - å®Œå¤‡çš„æƒé™ç®¡ç†ï¼ˆå›¢é˜Ÿã€è§’è‰²ã€ç”¨æˆ·æ§åˆ¶ï¼‰ï¼›
  - é•œåƒç®¡ç†ï¼›
  - å®¹å™¨ç®¡ç†ï¼›
  - ä¸»æœºå’Œé›†ç¾¤çŠ¶æ€æ˜¾ç¤ºï¼›
  - åº”ç”¨æ¨¡æ¿å¿«é€Ÿéƒ¨ç½²ï¼›
  - äº‹ä»¶æ—¥å¿—æ˜¾ç¤ºï¼›
  - å…¶å®ƒ`Docker`ç›¸å…³åŠŸèƒ½ç­‰ã€‚

### 3.1.1ï¼šå®‰è£…

å…ˆæ‹‰å–æœ€æ–°çš„é•œåƒï¼š

```
$ docker pull portainer/portainer:latest
```

ä¸º`Portainer`åˆ›å»ºä¸€ä¸ª`volume`ï¼š

```
$ docker volume create snail_portainer
```

ä¸€æ¡å‘½ä»¤å¯åŠ¨ï¼š

```
$ docker run -d -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v snail_portainer:/data portainer/portainer
```

æ³¨æ„`--restart=always`ä½œç”¨æ˜¯`Docker`é‡å¯æ—¶ï¼Œè‡ªåŠ¨é‡å¯å®¹å™¨ã€‚

æˆåŠŸå¯åŠ¨åï¼Œè®¿é—®åœ°å€`http://localhost:9000/`å°±å¯ä»¥äº†ã€‚

### 3.1.2: å‡ ä¸ªé‡è¦åŠŸèƒ½

ç¬¬ä¸€æ¬¡è¿›å…¥ç•Œé¢æ—¶ï¼Œéœ€è¦åˆ›å»ºç®¡ç†å‘˜è´¦å·ï¼Œå¯†ç é•¿åº¦å¿…é¡»è¦8ä½åŠä»¥ä¸Šã€‚12345678

![image-20210520124556335](https://gitee.com/snailzrg/snail_img/raw/master/picgo_snail_img/image-20210520124556335.png)



é…ç½®Localå®Œæˆåï¼ŒæŸ¥çœ‹`Dashboard`ï¼Œå°±èƒ½çœ‹åˆ°`Docker`ç¯å¢ƒçš„æ•´ä½“æƒ…å†µäº†ï¼Œå¦‚é•œåƒä¸ªæ•°ã€å®¹å™¨ä¸ªæ•°åŠè¿è¡ŒçŠ¶æ€ã€`Volume`ç­‰





## dockeråå°å¯åŠ¨ 

docker run --name snailzrgubt -d ubuntu /bin/bash	-c  "while true; do echo hello; sleep 2;done"

> ğŸ‘†ä¸Šé¢æ–¹å¼å¯åŠ¨å®¹å™¨ ä¸ä¼šç«‹å³é€€å‡º 

snailzhou@SnaildeMBP ~ % docker exec -it snailzrgubt /bin/bash



snailzhou@SnaildeMBP ~ % docker logs snailzrgubt

> ä¸Šé¢æŸ¥çœ‹å®¹å™¨æ—¥å¿—



## docker æŸ¥çœ‹å®¹å™¨ç»†èŠ‚

 docker inspect mysqlzrg

æ˜¾ç¤ºjsonä¸²





## docker åˆ†å±‚ç»“æ„

æ¯”å¦‚ ä¸‹è½½ä¸€ä¸ªtomcat ä¸­ å‘ç°å±…ç„¶400m

ç”±äº tomcatä¾èµ–--jdk8ä¾èµ–--centerosä¾èµ–--kernelï¼›

æ‰€ä»¥çœ‹æ‹‰tomcaté•œåƒä¸­ä¼šä¸‹è½½ä¸€å †idçš„é•œåƒ
