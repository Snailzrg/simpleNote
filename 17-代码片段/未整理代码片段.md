##  重排序
// 不推荐使用，粗略整理
```
List<DuesVo> subDuesVoList = new ArrayList<>();
		int totalCount = orgDuesvoList.size();
		int maxPage = (totalCount + pageSize - 1) / pageSize;
		// 验证
		if (pageNo == 0) {
			pageNo = 1;
		}
		if (pageSize == 0) {

			pageSize = 20;
		}
		if (pageNo > maxPage) {
			// 大于最后最大页数
			return null;
		}
		int pageEndRow = 20;
		int pageStartRow = 1;
		// 判断是否最后一页 开始下标 和结束下标
		if ((pageNo * pageSize) < totalCount) {
			pageEndRow = pageNo * pageSize;
			pageStartRow = pageEndRow - pageSize;
		} else {
			pageEndRow = totalCount;
			pageStartRow = pageSize * (pageNo - 1);

		}
		subDuesVoList = orgDuesvoList.subList(pageStartRow, pageEndRow);
Comparator comparator = ComparableComparator.getInstance();       
	        comparator = ComparatorUtils.naturalComparator();
	        // 创建一个排序链   
	        final ComparatorChain multiSort = new ComparatorChain(new BeanComparator("joinDate", comparator));    
	        // 开始真正的排序
	        Collections.sort(members, multiSort);
	        Collections.reverse(members);
	        detailVo.setMembers(members);	

```



//粗略代码 后续整理
```
note:Map<String,Integer>  sum= scores.stream().collect(  
	               Collectors.groupingBy(QuestionnarieScoreVo::getOrgName, Collectors.summingInt(QuestionnarieScoreVo::getScore)));  

1：工具类ExcelUtil
//文件上传类
IFileUploadDAO 下面的

a:根据文件id 获取文件的属性
Map<String, Object> attachMap = fileDao.queryFile(fileId);
	if (attachMap.get("fileName") == null || attachMap.get("userId") == null||
	 attachMap.get("fileType") == null || attachMap.get("fileLength") == null|| attachMap.get("uploadDate") == null) {
		continue;
		}
	attachVo.setAttachsId(fileId);
	attachVo.setAttachsName(attachMap.get("fileName").toString());
	attachVo.setUserId(attachMap.get("userId").toString());
	attachVo.setAttachsType(attachMap.get("fileType").toString());
	attachVo.setAttachsLength(Long.valueOf(attachMap.get("fileLength").toString()));
	String date = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(attachMap.get("uploadDate"));
	attachVo.setUploadDate(DateTimeUtil.parse(date));
	listVo.add(attachVo);
  }

    b:根据内容 生成Eexecl表单并且....下载
    	HSSFWorkbook wb = new HSSFWorkbook();
    	String excelName = socialTask.getTaskName() + "服务评价评分结果";	
    	String sheetName = "服务评价评分结果";//表单头名称
    	HSSFSheet sheet = wb.createSheet(sheetName);

	HSSFCellStyle cellStyle = initExcel(wb, sheetName);//初始化表格
	String[] head = { socialTask.getTaskName() + "统计报表" };
	String fileName = excelName + ".xls";
	//？
	sheet.addMergedRegion(new Region(0, (short) 0, 0, (short) 4));
	// 创建表格头部
	createHead(head, sheet, cellStyle);
	// 写入数据
	wirteQuestionnaireDate(detailVo, wb, questId, sheetName);

//初始化 表格样式
	public HSSFCellStyle initExcel(HSSFWorkbook wb, String name) {

		HSSFSheet sheet = wb.getSheet(name);

		sheet.setDefaultRowHeight((short) 350);
		HSSFFont font = wb.createFont();
		font.setFontName("黑体");
		font.setFontHeightInPoints((short) 12);// 设置字体大小

		HSSFCellStyle cellStyle = wb.createCellStyle();
		cellStyle.setAlignment(HSSFCellStyle.ALIGN_CENTER); // 居中
		cellStyle.setFont(font);
		return cellStyle;
	}

//创建表头
	public void createHead(String[] head, HSSFSheet sheet, HSSFCellStyle style) {
		if (head != null && head.length > 0) {
			HSSFRow row = sheet.createRow(0);
			for (int i = 0; i < head.length; i++) {
				HSSFRichTextString text = new HSSFRichTextString(head[i]);
				HSSFCell cell = row.createCell((short) i);
				cell.setCellValue(text);
				cell.setCellStyle(style);
			}
		}
	}

//写入数据......

//写入单元格数据
	public void writeCellDate(HSSFRow row, String[] data, HSSFWorkbook wb) {
		if (data != null && data.length > 0) {
			for (int i = 0; i < data.length; i++) {
				HSSFRichTextString text = new HSSFRichTextString(data[i]);
				HSSFCell cell = row.createCell((short) i);
				cell.setCellValue(text);
			}
		}
	}

```

---- 
反射

```

	final String str1 = viewCon[i].trim();
					final char[] chars = viewCon[i].trim().toCharArray();
					// 将field的首字母转为大写，因为set方法后跟的是首字母大写的属性
					chars[0] -= MAGIC_NUMBER;
					final Object rmethod = getGetMethod(gldxVO, str1);
					final Method method = entity.getClass().getMethod("set" + String.valueOf(chars),
							rmethod.getClass());
					method.invoke(entity, rmethod);
					
	/**
	 * 根据属性，获取get方法.
	 * 
	 * @param ob
	 *            对象
	 * @param name
	 *            属性名
	 * @return Object 值
	 * @throws Exception
	 */
	public static Object getGetMethod(final Object ob, final String name) {
		try {
			final Method[] m = ob.getClass().getMethods();
			for (int i = 0; i < m.length; i++) {
				if (("get" + name).toLowerCase().equals(m[i].getName().toLowerCase())) {
					final Object obj = m[i].invoke(ob);
					return obj == null ? "" : obj;
				}
			}
		} catch (Exception ex) {
			ex.printStackTrace();
		}
		return null;
	}
```